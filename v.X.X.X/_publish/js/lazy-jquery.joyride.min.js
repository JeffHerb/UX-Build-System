(function(e){e.fn.joyride=function(t){var n={tipLocation:"bottom left",scrollSpeed:300,timer:0,startTimerOnClick:!1,nextButton:!0,tipAnimation:"pop",tipAnimationFadeSpeed:300,cookieMonster:!1,cookieName:"JoyRide",cookieDomain:!1,tipContainer:"body",inline:!1,tipContent:"#joyRideTipContent",postRideCallback:e.noop,postStepCallback:e.noop};return t=e.extend(n,t),this.each(function(){if(e(t.tipContent).length===0)return;e(t.tipContent).hide();var r=e(t.tipContainer).children("*").first().position(),i=e(t.tipContent+" li"),s=0,o=0,u=-1,a,f='<div class="joyride-timer-indicator-wrap"><span class="joyride-timer-indicator"></span></div>',l=function(t,n,r,i){return'<div class="joyride-tip-guide '+t+'" id="joyRidePopup'+n+'"><span class="joyride-nub"></span><div class="joyride-content-wrapper">'+e(i).html()+r+'<a href="#close" class="joyride-close-tip">X</a>'+a+"</div></div>"},c=function(r,i,s,o){i===0&&n.startTimerOnClick&&n.timer>0||n.timer===0?a="":a=f,r||(r=""),s?s='<a href="#" class="joyride-next-tip small nice radius yellow button">'+s+"</a>":s="",n.inline?e(l(r,i,s,o)).insertAfter("#"+e(o).data("id")):e(t.tipContainer).append(l(r,i,s,o))};(!n.cookieMonster||!e.cookie(n.cookieName))&&i.each(function(t){var r=e(this).data("text"),i=e(this).attr("class"),s=this;n.nextButton&&!r&&(r="Next"),n.nextButton||!n.nextButton&&n.startTimerOnClick?e(this).attr("class")?c(i,t,r,s):c(!1,t,r,s):n.nextButton||(e(this).attr("class")?c(i,t,"",s):c(!1,t,"",s)),e("#joyRidePopup"+t).hide()}),showNextTip=function(){var t=e(i[s]).data("id"),a=e("#"+t),f={};e.each((e(i[s]).data("options")||":").split(";"),function(t,n){var r=n.split(":");r.length==2&&(f[e.trim(r[0])]=e.trim(r[1]))});var l=e.extend({},n,f);while(a.offset()===null){s++,o++,i.length-1>u&&u++,t=e(i[s]).data("id"),a=e("#"+t);if(e(i).length<s)break}var c=Math.ceil(e(window).height()/2),h=e("#joyRidePopup"+s),p=a.offset(),d=a.outerHeight(),v=h.outerHeight(),m=Math.ceil(e(".joyride-nub").outerHeight()/2),g=0;if(h.length===0)return;if(s<i.length){l.tipAnimation=="pop"?(e(".joyride-timer-indicator").width(0),l.timer>0?h.show().children(".joyride-timer-indicator-wrap").children(".joyride-timer-indicator").animate({width:e(".joyride-timer-indicator-wrap").width()},l.timer):h.show()):l.tipAnimation=="fade"&&(e(".joyride-timer-indicator").width(0),l.timer>0?h.fadeIn(l.tipAnimationFadeSpeed).children(".joyride-timer-indicator-wrap").children(".joyride-timer-indicator").animate({width:e(".joyride-timer-indicator-wrap").width()},l.timer):h.fadeIn(l.tipAnimationFadeSpeed));var y=h.children(".joyride-nub"),b=p.left-r.left;y.removeClass("bottom").removeClass("top").removeClass("right"),e(window).scrollLeft()+e(window).width()<b+h.width()&&(b-=h.width()-y.offset().left*2,y.addClass("right")),Modernizr.mediaqueries&&Modernizr.mq("only screen and (max-width: 769px)")?l.tipLocation.indexOf("top")!=-1?v>=p.top?(h.offset({top:p.top+d+m-r.top}),y.addClass("top").css({left:b})):(h.offset({top:p.top-(v+r.top+m)}),y.addClass("bottom").css({left:b})):(h.offset({top:p.top+d+m}),y.addClass("top").css({left:b})):l.tipLocation=="top"?v>=p.top?(h.offset({top:p.top+d+m-r.top,left:b}),y.addClass("top")):(h.offset({top:p.top-(v+r.top+m),left:b}),y.addClass("bottom")):(h.offset({top:p.top+d+m,left:b}),y.addClass("top")),l.tipLocation.indexOf("right")!=-1&&(h.offset({left:p.left-r.left-h.width()+a.width()}),h.children(".joyride-nub").addClass("right")),g=Math.ceil(h.offset().top-c),e("html, body").animate({scrollTop:g},l.scrollSpeed);if(s>0){var w;o>0?(w=u-o,o=0):w=u,l.tipAnimation=="pop"?e("#joyRidePopup"+w).hide():l.tipAnimation=="fade"&&e("#joyRidePopup"+w).fadeOut(l.tipAnimationFadeSpeed)}}else if(i.length-1<s){var E;o>0?(E=u-o,o=0):E=u,n.cookieMonster===!0&&e.cookie(n.cookieName,"ridden",{expires:365,domain:n.cookieDomain}),l.tipAnimation=="pop"?e("#joyRidePopup"+E).fadeTo(0,0):l.tipAnimation=="fade"&&e("#joyRidePopup"+E).fadeTo(l.tipAnimationFadeSpeed,0)}s++,u<0?u=0:i.length-1>u&&u++,n.postStepCallback!=e.noop&&n.postStepCallback(u)},(!n.inline||!n.cookieMonster||!e.cookie(n.cookieName))&&e(window).resize(function(){var t=e(i[u]).data("id"),s=e("#"+t).offset(),o=e("#"+t).outerHeight(),a=e("#joyRidePopup"+u).outerHeight(),f=Math.ceil(e(".joyride-nub").outerHeight()/2);Modernizr.mediaqueries&&Modernizr.mq("only screen and (max-width: 769px)")?n.tipLocation.indexOf("bottom")!=-1?(e("#joyRidePopup"+u).offset({top:s.top+o+f,left:0}),e("#joyRidePopup"+u).children(".joyride-nub").addClass("top").removeClass("bottom").css({left:s.left-r.left})):n.tipLocation.indexOf("top")!=-1&&(s.top<=a?(e("#joyRidePopup"+u).offset({top:s.top+f+o,left:0}),e("#joyRidePopup"+u).children(".joyride-nub").addClass("top").removeClass("bottom").css({left:s.left-r.left})):(e("#joyRidePopup"+u).offset({top:s.top-(a+f),left:0}),e("#joyRidePopup"+u).children(".joyride-nub").addClass("bottom").removeClass("top").css({left:s.left-r.left}))):n.tipLocation=="bottom"?(e("#joyRidePopup"+u).offset({top:s.top+o+f,left:s.left}),e("#joyRidePopup"+u).children(".joyride-nub").addClass("top").removeClass("bottom").css({left:""})):n.tipLocation=="top"&&(s.top<=a?(e("#joyRidePopup"+u).offset({top:s.top+f+o,left:s.left}),e("#joyRidePopup"+u).children(".joyride-nub").addClass("top").removeClass("bottom").css({left:""})):(e("#joyRidePopup"+u).offset({top:s.top-(a+f),left:s.left}),e("#joyRidePopup"+u).children(".joyride-nub").addClass("bottom").removeClass("top").css({left:""})))});var h=null,p=!1;!n.startTimerOnClick&&n.timer>0?(showNextTip(),h=setInterval(function(){showNextTip()},n.timer)):showNextTip();var d=function(t,r,i,s){t.preventDefault(),clearInterval(r),i&&e.cookie(n.cookieName,"ridden",{expires:365,domain:n.cookieDomain}),e(s).parent().parent().hide(),n.postRideCallback!=e.noop&&n.postRideCallback()};e(".joyride-close-tip").click(function(e){d(e,h,n.cookieMonster,this)}),e(".joyride-next-tip").click(function(e){e.preventDefault(),s>=i.length&&d(e,h,n.cookieMonster,this),n.timer>0&&n.startTimerOnClick?(showNextTip(),clearInterval(h),h=setInterval(function(){showNextTip()},n.timer)):n.timer>0&&!n.startTimerOnClick?(clearInterval(h),h=setInterval(function(){showNextTip()},n.timer)):showNextTip()})})},jQuery.cookie=function(e,t,n){if(arguments.length>1&&String(t)!=="[object Object]"){n=jQuery.extend({},n);if(t===null||t===undefined)n.expires=-1;if(typeof n.expires=="number"){var r=n.expires,i=n.expires=new Date;i.setDate(i.getDate()+r)}return t=String(t),document.cookie=[encodeURIComponent(e),"=",n.raw?t:encodeURIComponent(t),n.expires?"; expires="+n.expires.toUTCString():"",n.path?"; path="+n.path:"",n.domain?"; domain="+n.domain:"",n.secure?"; secure":""].join("")}n=t||{};var s,o=n.raw?function(e){return e}:decodeURIComponent;return(s=(new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)")).exec(document.cookie))?o(s[1]):null}})(jQuery);